<!DOCTYPE html>
<html>
<head>
    <title>JS test</title>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-bottom">
        <div class="container px-4 px-lg-5">
            <a class="navbar-brand" href="#!">Dynamic creation of telegram bots</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item active">
                        <a class="nav-link" href="#!" id="homeMainButton">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#!">About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#!">Services</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#!">Contact</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div aria-live="polite" aria-atomic="true" class="position-relative" style="max-height: 100%;">
        <div class="toast-container top-0 end-0 p-3" id="toastMessages">
        </div>
    </div>

    <section class="vh-100" id="mainFrame">
        <div class="container py-5 h-100" id="loginFrame">
            <div class="row d-flex justify-content-center align-items-center h-100">
                <div class="col-12 col-md-8 col-lg-6 col-xl-5">
                    <div class="card bg-dark text-white" style="border-radius: 1rem;">
                        <div class="card-body p-5 text-center">

                            <div class="mb-md-5 mt-md-4 pb-5">
                                <form>
                                    <h2 class="fw-bold mb-2 text-uppercase">Login</h2>
                                    <p class="text-white-50 mb-5">Please login to your account!</p>
                                    <div class="bsk-container">
                                    </div>
                                </form>
                                <button class="bsk-btn bsk-btn-default" id="loginButton">
                                    <object type="image/svg+xml" data="https://s3-eu-west-1.amazonaws.com/cdn-testing.web.bas.ac.uk/scratch/bas-style-kit/ms-pictogram/ms-pictogram.svg" class="x-icon"></object>
                                    Sign in with Microsoft
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="container py-5 h-100" id="botsListFrame" hidden>
            <div class="row d-flex justify-content-center align-items-center h-100">
                <div class="col-12 col-md-8 col-lg-6 col-xl-5">
                    <div class="card bg-dark text-white" style="border-radius: 1rem;">
                        <div class="card-body p-5 text-center">

                            <div id="presentTelegramBots"></div>
                            <div id="newTelegramBots"></div>

                        </div>
                    </div>
                </div>
            </div>
        </div>


        <div class="container py-5 h-100" id="commandActions">
            <table>
                <thead>
                    <tr>
                        <td>
                            <button id="Commands">Commands</button>
                        </td>
                        <td>
                            <button id="CommandActionText">Text</button>
                        </td>
                        <td>
                            <button id="CommandActionPost">Post</button>
                        </td>
                        <td>
                            <button id="CommandActionInline">Inline</button>
                        </td>
                        <td>
                            <button id="CommandActionReply">Reply</button>
                        </td>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td colspan="4">
                            <div id="presentComandActions"></div>
                            <div id="newComandActions"></div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

    </section>


    <script type="text/javascript" src="js/models.js"></script>
    <script type="text/javascript" src="js/scripts.js"></script>
    <script type="text/javascript" src="js/command.js"></script>
    <script type="text/javascript" src="js/commandAction.js"></script>
    <script type="text/javascript" src="js/telegramBot.js"></script>
    <link rel="stylesheet" href="css/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://getbootstrap.com/docs/5.2/assets/css/docs.css" rel="stylesheet">

<script>
        if (jwtToken != null) {

            (async () => {
                await await GetToTelegramBotsPage();
            })();
    }

    let accessToken = new URL(window.location.href.replace(/#/g, "?")).searchParams.get("access_token");
    if (accessToken != null) {
        jwtToken = accessToken;
        window.location.hash = "";
        (async () => {
            await await GetToTelegramBotsPage();
        })();
        }

        document.getElementById("loginButton").onclick = function () {
            window.location.replace(`${url}login`);
        }
        console.log(jwtToken);
    async function GetToTelegramBotsPage() {

        await GetTelegramBots();
            document.getElementById("loginFrame").hidden = true;
            document.getElementById("botsListFrame").hidden = false;
        }
    </script>
</body>
</html>